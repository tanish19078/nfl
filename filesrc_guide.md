# Codebase Guide (File Reader)

This document provides a comprehensive overview of the project structure, explaining the purpose of each directory and key file. It is designed to help new developers quickly understand the codebase.

## Root Directory
-   **`README.md`**: The main entry point for documentation. Contains project overview, setup instructions, and usage examples.
-   **`final_check`**: A summary report of the project's final status, including key results, metrics, and technical achievements.
-   **`requirements.txt`**: Lists all Python dependencies required to run the project.
-   **`.gitignore`**: Specifies files and directories that should be ignored by Git (e.g., virtual environments, data, large model files).
-   **`submission.csv`**: The output file generated by the inference pipeline, containing predicted trajectories for the test set.
-   **`inference_plot.png`**: A visualization of the model's predictions on a sample play.
-   **`nfl-big-data-bowl-2026-prediction/`**: (Directory) Contains the raw input data (train/test CSVs) provided by the competition.

## Source Code (`src/`)
The core logic of the application resides here.

### `src/` Root
-   **`evaluate.py`**: A script to evaluate the trained model on the validation set. Computes metrics like ADE, FDE, and RMSE.
-   **`inference_demo.py`**: A demonstration script for running inference on a single example (useful for quick testing).

### `src/data/`
Handles data loading, processing, and splitting.
-   **`dataset.py`**: Defines the `NFLDataset` class (PyTorch Dataset). Handles loading CSVs, merging features, and preparing tensors.
-   **`split.py`**: Contains logic for splitting data into training and validation sets (e.g., `get_train_val_split`), ensuring no game leakage.
-   **`verify_split.py`**: A utility script to verify that the train/val split is valid and disjoint.
-   **`verify_dataset.py` / `verify_pandas.py`**: Helper scripts for debugging data loading and pandas operations.

### `src/features/`
Responsible for feature engineering.
-   **`features.py`**: The main pipeline for transforming raw tracking data into model features. Includes:
    -   Standardizing play direction (left-to-right).
    -   Calculating velocity, acceleration, and orientation.
    -   Encoding player roles (Passer, Receiver, etc.).

### `src/models/`
Contains neural network architectures and saved weights.
-   **`model.py`**: Defines the main `TrajectoryPredictor` class (Hybrid LSTM-GNN architecture).
-   **`architecture.py`**: Contains auxiliary or alternative architecture definitions.
-   **`best_model.pth`**: The saved state dictionary (weights) of the best-performing model during training.

### `src/training/`
Scripts related to model training.
-   **`train.py`**: The main training script. Sets up the training loop, loss function (Masked MSE), optimizer, and validation logging.

### `src/inference/`
Scripts for generating final predictions.
-   **`inference.py`**: The production inference script. Loads the test set, runs the model, post-processes predictions (coordinate restoration), and generates `submission.csv`.
